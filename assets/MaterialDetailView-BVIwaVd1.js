import{u as I,l as N,o,c as r,b as t,n as l,t as n,d as y,F as R,r as V,x as E,y as O,z as A,A as H,j as d,e as Q,B as u,f as U,C as J}from"./index-R9P4HaMK.js";import{b as G}from"./browser-JP79f-a9.js";const K={class:"page-container"},P={class:"page-content"},W={key:0,class:"flex justify-center py-12"},X={key:1,class:"text-center py-12"},Y={key:2},Z={class:"flex items-center justify-between"},tt={class:"text-right"},et={class:"text-4xl font-bold text-gray-800"},st={class:"text-sm text-gray-500"},at={class:"card mb-4 text-center"},nt={key:0,class:"bg-white p-4 rounded-xl inline-block mb-2"},ot=["src"],rt={class:"text-lg font-mono font-bold text-primary-600"},it={class:"card mb-4"},lt={class:"space-y-3"},dt={class:"flex justify-between"},ut={class:"text-sm font-medium text-gray-800"},ct={class:"flex justify-between"},xt={class:"text-sm font-medium text-gray-800"},mt={class:"flex justify-between"},ft={class:"text-sm font-medium text-gray-800"},yt={class:"grid grid-cols-2 gap-4"},gt={class:"text-sm font-medium text-gray-800"},pt={class:"text-sm font-medium text-gray-800"},vt={class:"flex justify-between"},bt={class:"text-sm font-medium text-gray-800"},_t={class:"flex justify-between"},wt={class:"text-sm font-medium text-gray-800"},ht={class:"flex justify-between"},kt={class:"text-sm font-medium text-gray-800"},Ct={class:"flex justify-between"},jt={class:"text-sm font-medium text-gray-800"},Dt={class:"card mb-4"},Bt={class:"space-y-3"},St={class:"flex justify-between"},$t={class:"text-sm font-medium text-gray-800"},Mt={class:"flex justify-between"},Lt={class:"card mb-4"},qt={class:"space-y-3"},Tt={class:"flex justify-between"},zt={class:"text-sm font-medium text-gray-800"},Ft={class:"flex justify-between"},It={class:"text-sm font-medium text-gray-800"},Nt={key:0,class:"flex justify-between"},Rt={class:"text-sm font-medium text-gray-800"},Vt={key:1,class:"flex justify-between"},Et={class:"text-sm font-medium text-gray-800"},Ot={class:"card mb-4"},At={key:0,class:"text-center py-4 text-gray-500"},Ht={key:1,class:"space-y-3"},Qt={class:"flex-1"},Ut={class:"text-sm font-medium text-gray-800"},Jt={class:"text-xs text-gray-500"},Wt={__name:"MaterialDetailView",setup(Gt){const g=U(),_=J(),w=I(),a=d(null),c=d([]),x=d(""),m=d(!0),f=Q(()=>_.params.id),p={render(){return u("svg",{fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[u("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})])}},h={render(){return u("svg",{fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[u("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M17 13l-5 5m0 0l-5-5m5 5V6"})])}};function v(s){return s?new Date(s).toLocaleDateString("zh-CN"):"-"}function k(s){return s?new Date(s).toLocaleString("zh-CN"):"-"}function C(s){return{normal:"正常",warning:"即将过期",expired:"已过期",out_of_stock:"缺货"}[s]||s}function j(s){const e="badge";switch(s){case"normal":return`${e} badge-success`;case"warning":return`${e} badge-warning`;case"expired":return`${e} badge-danger`;default:return`${e} bg-gray-100 text-gray-600`}}function D(s){switch(s){case"normal":return"bg-green-50 border border-green-200";case"warning":return"bg-yellow-50 border border-yellow-200";case"expired":return"bg-red-50 border border-red-200";default:return"bg-gray-50 border border-gray-200"}}function B(s){if(!s)return!1;const e=new Date(s),b=Math.ceil((e-new Date)/(1e3*60*60*24));return b<=30&&b>=0}function S(s){switch(s){case"inbound":return p;case"outbound":return h;default:return p}}function $(s){switch(s){case"inbound":return"bg-green-100 text-green-600";case"outbound":return"bg-blue-100 text-blue-600";default:return"bg-gray-100 text-gray-600"}}function M(s){const i={inbound:"入库",outbound:"出库",update:"更新",delete:"删除"}[s.operation]||s.operation;return s.operation==="outbound"?`${s.operator} 出库 ${s.quantity} ${s.reason?`- ${s.reason}`:""}`:`${s.operator} ${i}`}async function L(){try{const s=JSON.stringify({id:a.value.id,unique_code:a.value.unique_code,name:a.value.name});x.value=await G.toDataURL(s,{width:160,margin:2,color:{dark:"#1e40af",light:"#ffffff"}})}catch(s){console.error("生成二维码失败:",s)}}async function q(){m.value=!0;try{a.value=await A(f.value),c.value=await H(f.value),await L()}catch(s){alert("获取数据失败: "+s.message)}finally{m.value=!1}}function T(){g.push("/outbound")}function z(){alert("编辑功能开发中")}async function F(){if(confirm("确定要删除这个材料吗？此操作不可撤销。"))try{await w.deleteMaterial(f.value),alert("删除成功"),g.push("/inventory")}catch(s){alert("删除失败: "+s.message)}}return N(()=>{q()}),(s,e)=>(o(),r("div",K,[t("div",P,[m.value?(o(),r("div",W,[...e[0]||(e[0]=[t("svg",{class:"animate-spin h-8 w-8 text-primary-600",fill:"none",viewBox:"0 0 24 24"},[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)])])):a.value?(o(),r("div",Y,[t("div",{class:l(["card mb-4",D(a.value.status)])},[t("div",Z,[t("div",null,[t("span",{class:l(j(a.value.status))},n(C(a.value.status)),3)]),t("div",tt,[t("p",et,n(a.value.quantity),1),t("p",st,n(a.value.unit),1)])])],2),t("div",at,[e[2]||(e[2]=t("h3",{class:"text-base font-semibold text-gray-800 mb-4"},"唯一标识",-1)),x.value?(o(),r("div",nt,[t("img",{src:x.value,alt:"QR Code",class:"w-40 h-40"},null,8,ot)])):y("",!0),t("p",rt,n(a.value.unique_code),1),e[3]||(e[3]=t("p",{class:"text-xs text-gray-500 mt-1"},"扫码快速查看详情",-1))]),t("div",it,[e[13]||(e[13]=t("h3",{class:"text-base font-semibold text-gray-800 mb-4"},"基本信息",-1)),t("div",lt,[t("div",dt,[e[4]||(e[4]=t("span",{class:"text-sm text-gray-500"},"标准物质编号",-1)),t("span",ut,n(a.value.standard_number||"-"),1)]),t("div",ct,[e[5]||(e[5]=t("span",{class:"text-sm text-gray-500"},"名称",-1)),t("span",xt,n(a.value.name),1)]),t("div",mt,[e[6]||(e[6]=t("span",{class:"text-sm text-gray-500"},"生成厂家",-1)),t("span",ft,n(a.value.manufacturer||"-"),1)]),t("div",yt,[t("div",null,[e[7]||(e[7]=t("span",{class:"text-sm text-gray-500 block"},"浓度",-1)),t("span",gt,n(a.value.concentration?parseFloat(a.value.concentration).toFixed(6):"-"),1)]),t("div",null,[e[8]||(e[8]=t("span",{class:"text-sm text-gray-500 block"},"不确定度",-1)),t("span",pt,n(a.value.uncertainty?parseFloat(a.value.uncertainty).toFixed(6):"-"),1)])]),t("div",vt,[e[9]||(e[9]=t("span",{class:"text-sm text-gray-500"},"批号",-1)),t("span",bt,n(a.value.batch||"-"),1)]),t("div",_t,[e[10]||(e[10]=t("span",{class:"text-sm text-gray-500"},"规格",-1)),t("span",wt,n(a.value.specification||"-"),1)]),t("div",ht,[e[11]||(e[11]=t("span",{class:"text-sm text-gray-500"},"分类",-1)),t("span",kt,n(a.value.category||"-"),1)]),t("div",Ct,[e[12]||(e[12]=t("span",{class:"text-sm text-gray-500"},"操作人员",-1)),t("span",jt,n(a.value.operator||"-"),1)])])]),t("div",Dt,[e[16]||(e[16]=t("h3",{class:"text-base font-semibold text-gray-800 mb-4"},"日期信息",-1)),t("div",Bt,[t("div",St,[e[14]||(e[14]=t("span",{class:"text-sm text-gray-500"},"生产日期",-1)),t("span",$t,n(v(a.value.production_date)),1)]),t("div",Mt,[e[15]||(e[15]=t("span",{class:"text-sm text-gray-500"},"有效期至",-1)),t("span",{class:l(["text-sm font-medium",B(a.value.expiry_date)?"text-yellow-600":""])},n(v(a.value.expiry_date)),3)])])]),t("div",Lt,[e[21]||(e[21]=t("h3",{class:"text-base font-semibold text-gray-800 mb-4"},"存放信息",-1)),t("div",qt,[t("div",Tt,[e[17]||(e[17]=t("span",{class:"text-sm text-gray-500"},"存放位置",-1)),t("span",zt,n(a.value.storage_location||"-"),1)]),t("div",Ft,[e[18]||(e[18]=t("span",{class:"text-sm text-gray-500"},"供应商",-1)),t("span",It,n(a.value.supplier||"-"),1)]),a.value.storage_conditions?(o(),r("div",Nt,[e[19]||(e[19]=t("span",{class:"text-sm text-gray-500"},"存储条件",-1)),t("span",Rt,n(a.value.storage_conditions),1)])):y("",!0),a.value.dilution_conditions?(o(),r("div",Vt,[e[20]||(e[20]=t("span",{class:"text-sm text-gray-500"},"稀释条件",-1)),t("span",Et,n(a.value.dilution_conditions),1)])):y("",!0)])]),t("div",Ot,[e[22]||(e[22]=t("h3",{class:"text-base font-semibold text-gray-800 mb-4"},"操作记录",-1)),c.value.length===0?(o(),r("div",At," 暂无操作记录 ")):(o(),r("div",Ht,[(o(!0),r(R,null,V(c.value,i=>(o(),r("div",{key:i.id,class:"flex items-start"},[t("div",{class:l(["w-8 h-8 rounded-full flex items-center justify-center mr-3",$(i.operation)])},[(o(),E(O(S(i.operation)),{class:"w-4 h-4"}))],2),t("div",Qt,[t("p",Ut,n(M(i)),1),t("p",Jt,n(k(i.created_at)),1)])]))),128))]))]),t("div",{class:"flex space-x-4"},[t("button",{onClick:T,class:"btn btn-success flex-1 py-3"}," 出库 "),t("button",{onClick:z,class:"btn btn-secondary flex-1 py-3"}," 编辑 ")]),t("button",{onClick:F,class:"btn btn-danger w-full mt-4 py-3"}," 删除材料 ")])):(o(),r("div",X,[...e[1]||(e[1]=[t("p",{class:"text-gray-500"},"材料不存在",-1)])]))])]))}};export{Wt as default};
