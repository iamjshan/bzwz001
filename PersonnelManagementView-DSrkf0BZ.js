import{l as S,o as i,c as r,b as e,h as d,v as u,i as v,F as z,r as H,t as m,d as w,w as q,q as F,D as A,j as p,e as U,E as I,G as N,H as $}from"./index-R9P4HaMK.js";const E={class:"page-container"},O={class:"page-content"},T={class:"mb-4"},G={class:"relative"},P={key:0,class:"flex justify-center py-12"},Q={key:1,class:"text-center py-12"},R={key:2,class:"space-y-3"},J={class:"flex items-center"},K={class:"w-12 h-12 bg-primary-100 rounded-full flex items-center justify-center mr-4"},W={class:"text-primary-600 font-medium"},X={class:"font-medium text-gray-800"},Y={class:"text-sm text-gray-500"},Z={class:"flex items-center mt-1 space-x-2"},ee={class:"badge bg-blue-100 text-blue-700 text-xs"},te={key:0,class:"badge bg-gray-100 text-gray-700 text-xs"},se={class:"flex space-x-2"},le=["onClick"],oe=["onClick"],ae={key:3,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"},ne={class:"bg-white rounded-xl p-6 w-full max-w-md"},ie={class:"text-lg font-semibold text-gray-800 mb-4"},re={class:"mb-4"},de=["disabled"],ue={class:"mb-4"},me=["disabled"],pe={class:"mb-4"},ve=["disabled"],ce={class:"mb-4"},be=["disabled"],xe={class:"mb-4"},fe=["disabled"],ye={class:"mb-4"},we=["disabled"],ge={key:0,class:"mb-4"},he=["disabled"],ke={class:"flex space-x-3 pt-4"},_e=["disabled"],Ue=["disabled"],Me={__name:"PersonnelManagementView",setup(Ce){const x=p([]),f=p(!0),c=p(""),b=p(!1),n=p(null),a=p(!1),s=p({name:"",email:"",position:"",role:"",department:"",phone:"",password:""}),g=U(()=>{if(!c.value)return x.value;const o=c.value.toLowerCase();return x.value.filter(t=>t.name.toLowerCase().includes(o)||t.email.toLowerCase().includes(o)||t.position&&t.position.toLowerCase().includes(o)||t.department&&t.department.toLowerCase().includes(o))}),h=U(()=>s.value.name&&s.value.email&&s.value.role&&(!n.value||s.value.password===""));function C(o){return{admin:"管理员",operator:"操作员",viewer:"查看者"}[o]||o}async function y(){try{f.value=!0,x.value=await A()}catch(o){console.error("加载用户失败:",o),alert("加载用户失败: "+o.message)}finally{f.value=!1}}function V(){}function M(){k(),n.value=null,b.value=!0}function j(o){n.value=o,s.value={name:o.name,email:o.email,position:o.position||"",role:o.role,department:o.department||"",phone:o.phone||"",password:""},b.value=!0}function k(){s.value={name:"",email:"",position:"",role:"",department:"",phone:"",password:""}}function _(){b.value=!1,n.value=null,k(),a.value=!1}async function B(){if(!h.value){alert("请填写必填项");return}a.value=!0;try{n.value?(await N(n.value.id,{name:s.value.name,position:s.value.position,role:s.value.role,department:s.value.department,phone:s.value.phone}),alert("用户信息更新成功")):(await $({id:crypto.randomUUID(),name:s.value.name,email:s.value.email,position:s.value.position,role:s.value.role,department:s.value.department,phone:s.value.phone,created_at:new Date().toISOString(),updated_at:new Date().toISOString()}),alert("用户创建成功")),await y(),_()}catch(o){console.error("保存用户失败:",o),alert("保存失败: "+o.message)}finally{a.value=!1}}async function L(o){if(confirm("确定要删除这个用户吗？此操作不可撤销。"))try{await I(o),alert("用户删除成功"),await y()}catch(t){console.error("删除用户失败:",t),alert("删除失败: "+t.message)}}return S(async()=>{await y()}),(o,t)=>(i(),r("div",E,[e("div",O,[t[22]||(t[22]=e("div",{class:"mb-6"},[e("h2",{class:"text-xl font-semibold text-gray-800"},"人员管理"),e("p",{class:"text-sm text-gray-500 mt-1"},"管理员工账户、角色和权限")],-1)),e("div",T,[e("div",G,[d(e("input",{"onUpdate:modelValue":t[0]||(t[0]=l=>c.value=l),type:"text",class:"input pl-10",placeholder:"搜索员工姓名或邮箱...",onInput:V},null,544),[[u,c.value]]),t[8]||(t[8]=e("svg",{class:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})],-1))])]),e("div",{class:"flex justify-end mb-4"},[e("button",{onClick:M,class:"btn btn-primary flex items-center"},[...t[9]||(t[9]=[e("svg",{class:"w-5 h-5 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})],-1),v(" 添加人员 ",-1)])])]),f.value?(i(),r("div",P,[...t[10]||(t[10]=[e("svg",{class:"animate-spin h-8 w-8 text-primary-600",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)])])):g.value.length===0?(i(),r("div",Q,[...t[11]||(t[11]=[e("svg",{class:"mx-auto h-12 w-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197m13.5-9a2.5 2.5 0 11-5 0 2.5 2.5 0 015 0z"})],-1),e("p",{class:"mt-2 text-gray-500"},"暂无人员信息",-1)])])):(i(),r("div",R,[(i(!0),r(z,null,H(g.value,l=>(i(),r("div",{key:l.id,class:"card flex items-center justify-between p-4"},[e("div",J,[e("div",K,[e("span",W,m(l.name.charAt(0)),1)]),e("div",null,[e("h3",X,m(l.name),1),e("p",Y,m(l.email),1),e("div",Z,[e("span",ee,m(C(l.role)),1),l.position?(i(),r("span",te,m(l.position),1)):w("",!0)])])]),e("div",se,[e("button",{onClick:D=>j(l),class:"p-2 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded-lg transition-colors",title:"编辑"},[...t[12]||(t[12]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1)])],8,le),e("button",{onClick:D=>L(l.id),class:"p-2 text-red-500 hover:text-red-700 hover:bg-red-50 rounded-lg transition-colors",title:"删除"},[...t[13]||(t[13]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)])],8,oe)])]))),128))])),b.value?(i(),r("div",ae,[e("div",ne,[e("h3",ie,m(n.value?"编辑人员":"添加人员"),1),e("form",{onSubmit:q(B,["prevent"])},[e("div",re,[t[14]||(t[14]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[v("姓名 "),e("span",{class:"text-red-500"},"*")],-1)),d(e("input",{"onUpdate:modelValue":t[1]||(t[1]=l=>s.value.name=l),type:"text",class:"input w-full",placeholder:"请输入姓名",required:"",disabled:a.value},null,8,de),[[u,s.value.name,void 0,{trim:!0}]])]),e("div",ue,[t[15]||(t[15]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[v("邮箱 "),e("span",{class:"text-red-500"},"*")],-1)),d(e("input",{"onUpdate:modelValue":t[2]||(t[2]=l=>s.value.email=l),type:"email",class:"input w-full",placeholder:"请输入邮箱地址",required:"",disabled:n.value||a.value},null,8,me),[[u,s.value.email,void 0,{trim:!0}]])]),e("div",pe,[t[16]||(t[16]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"岗位",-1)),d(e("input",{"onUpdate:modelValue":t[3]||(t[3]=l=>s.value.position=l),type:"text",class:"input w-full",placeholder:"请输入岗位",disabled:a.value},null,8,ve),[[u,s.value.position,void 0,{trim:!0}]])]),e("div",ce,[t[18]||(t[18]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[v("角色 "),e("span",{class:"text-red-500"},"*")],-1)),d(e("select",{"onUpdate:modelValue":t[4]||(t[4]=l=>s.value.role=l),class:"input w-full",required:"",disabled:a.value},[...t[17]||(t[17]=[e("option",{value:""},"请选择角色",-1),e("option",{value:"admin"},"管理员",-1),e("option",{value:"operator"},"操作员",-1),e("option",{value:"viewer"},"查看者",-1)])],8,be),[[F,s.value.role]])]),e("div",xe,[t[19]||(t[19]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"部门",-1)),d(e("input",{"onUpdate:modelValue":t[5]||(t[5]=l=>s.value.department=l),type:"text",class:"input w-full",placeholder:"请输入部门",disabled:a.value},null,8,fe),[[u,s.value.department,void 0,{trim:!0}]])]),e("div",ye,[t[20]||(t[20]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"电话",-1)),d(e("input",{"onUpdate:modelValue":t[6]||(t[6]=l=>s.value.phone=l),type:"tel",class:"input w-full",placeholder:"请输入电话号码",disabled:a.value},null,8,we),[[u,s.value.phone,void 0,{trim:!0}]])]),n.value?w("",!0):(i(),r("div",ge,[t[21]||(t[21]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[v("初始密码 "),e("span",{class:"text-red-500"},"*")],-1)),d(e("input",{"onUpdate:modelValue":t[7]||(t[7]=l=>s.value.password=l),type:"password",class:"input w-full",placeholder:"请输入初始密码",required:"",minlength:"6",disabled:a.value},null,8,he),[[u,s.value.password]])])),e("div",ke,[e("button",{onClick:_,type:"button",class:"btn btn-secondary flex-1 py-2",disabled:a.value}," 取消 ",8,_e),e("button",{type:"submit",class:"btn btn-primary flex-1 py-2",disabled:a.value||!h.value},m(a.value?"保存中...":n.value?"更新":"创建"),9,Ue)])],32)])])):w("",!0)])]))}};export{Me as default};
